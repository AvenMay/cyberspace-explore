# Hardware Debugging

### 1. 硅片级的“后门”：JTAG 与 SWD

这是最基础的调试方式。通过这些专用的物理接口，你可以直接控制 CPU 的内核。

- **工作原理：** 它们允许你设置硬件断点、单步执行指令、以及直接读取/修改内存和寄存器的值。
  
- **主流工具：**
  
  - **J-Link (Segger)：** 行业标准，速度极快，支持几乎所有 ARM/RISC-V 芯片。
    
  - **DAP-Link：** 开源标准，很多开发板（如 Pico, STM32 Nucleo）自带或可以廉价 DIY。
    
  - **ST-Link：** 专用于 STM32 系列。
    
- **调试体验：** 在 VS Code 或 Keil 中点击调试，代码会停在硬件的某一物理行，这本质上就是通过 SWD/JTAG 实现的。
  

---

### 2. 协议的“翻译官”：逻辑分析仪 (Logic Analyzer)

当你发现 MCU 发出了数据，但外设（如 OLED 或传感器）没反应时，你需要看波形。

- **核心功能：** 捕捉数字信号（0 和 1），并自动解码协议（如 I2C, SPI, UART, CAN, USB）。
  
- **推荐工具：**
  
  - **Saleae Logic：** 软件界面极其优雅，支持海量协议分析。
    
  - **入门款（基于 24MHz/8通道）：** 淘宝上十几块钱的蓝色小盒子。虽然带宽低，但学习 I2C/SPI 足够了。
    
- **学习点：** 亲眼看到数据包是如何在几根导线上跳动的，比读一百遍 Datasheet 都要直观。
  

---

### 3. 物理世界的“X光”：示波器 (Oscilloscope)

逻辑分析仪只能看 0 和 1，而示波器能看到**真实波形的形状**。

- **为什么要用：** 信号完整性（Signal Integrity）问题。比如波形边缘太圆（上升沿缓慢）、电压不够、或者有干扰噪声导致逻辑判断出错。
  
- **应用场景：** 电源纹波分析、高速总线调试、模拟电路分析。
  
- **推荐：** Rigol（普源）或 Siglent（鼎阳）的入门款，或者是基于 PC 的虚拟示波器。
  

---

### 4. 现代黑客的利器：系统级调试与 eBPF

考虑到你对 **Reverse Engineering** 和 **eBPF** 的兴趣，硬件调试在现代系统层有更高级的玩法：

- **交互式调试：** 使用像 **Bus Pirate (总线海盗)** 这样的工具，直接通过电脑串口发指令控制硬件外设，无需写代码。
  
- **eBPF + 硬件中断：** 在更高级的 SBC (如树莓派) 上，你可以通过 eBPF 监控内核如何处理硬件中断（IRQ），分析驱动程序的延迟和瓶颈。
  
- **硬件漏洞分析：** 在进行安全研究时，你会用到 **Fault Injection (故障注入)** 工具（如 ChipWhisperer），通过在特定时机干扰时钟或电压，绕过芯片的加密校验。
  

---

### 5. 硬件调试工具箱清单 (2026 推荐)

| **工具** | **解决什么问题** | **推荐级别** |
| --- | --- | --- |
| **Multimeter (万用表)** | 线通不通？电压对不对？是否短路？ | **必买** (基础中的基础) |
| **DAP-Link / ST-Link** | 烧录代码、在线单步调试、看寄存器。 | **必买** (嵌入式开发核心) |
| **Logic Analyzer** | 为什么传感器不回数据？通信协议对吗？ | **强烈推荐** (极高性价比) |
| **Serial to USB (TTL)** | 打印 `printf` 调试信息。 | **必买** (最简单的调试出口) |
| **Oscilloscope** | 电源稳吗？信号变形了吗？ | 进阶后购买 (较贵) |